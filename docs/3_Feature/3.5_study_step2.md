# 3.5 Logic Bước 2: Flashcard & Phân loại (SRS Lite)

## 1. Mô tả
Đây là bước quan trọng nhất giúp người dùng ghi nhớ sâu. Hệ thống mô phỏng cách học Flashcard nhưng có tính năng lọc từ: chỉ học lại những từ chưa thuộc.

- **Component:** `src/components/StudyStep2.jsx`
- **Mục tiêu:** Di chuyển tất cả từ vựng từ trạng thái "Chưa biết" sang "Đã thuộc".

## 2. Quản lý Trạng thái (Data States)
Sử dụng 3 mảng chính để quản lý vòng đời của từ vựng trong phiên học:

| Tên State | Kiểu | Mô tả |
| :--- | :--- | :--- |
| `pool` | Array | Danh sách từ đang hiển thị ở vòng hiện tại. Ban đầu chứa tất cả từ của bài học. |
| `learned` | Array | Danh sách các từ người dùng đã đánh dấu "Đã thuộc" (Thẻ xanh). |
| `unlearned` | Array | Danh sách các từ người dùng đánh dấu "Chưa thuộc" hoặc "Nhớ sai" (Thẻ đỏ). |
| `revealedIds` | Object | Lưu trạng thái lật thẻ của từng từ (Key: ID, Value: true/false). |

## 3. Quy trình Xử lý (Logic Flow)

### A. Tương tác Người dùng
Mỗi từ vựng (Card) có 2 giai đoạn tương tác:

1.  **Giai đoạn 1: Chưa lật thẻ (Mặc định)**
    - **Nút "Nhớ từ này":** -> `handleReveal(id)` -> Lật thẻ để hiện nghĩa tiếng Việt (chuyển sang Giai đoạn 2).
    - **Nút "Quên từ này":** -> `handleForgotImmediately(word)` -> Bỏ ngay vào nhóm `unlearned`, xóa khỏi `pool`.

2.  **Giai đoạn 2: Đã lật thẻ (Revealed)**
    - Người dùng kiểm tra xem mình nhớ đúng hay sai.
    - **Nút "Đã thuộc":** -> `handleConfirmKnown(word)` -> Thêm vào `learned`, xóa khỏi `pool`.
    - **Nút "Nhớ sai":** -> `handleConfirmWrong(word)` -> Thêm vào `unlearned`, xóa khỏi `pool`.

### B. Logic Vòng lặp (Retry Logic)
Khi người dùng xử lý hết từ trong `pool` (pool rỗng), hệ thống kiểm tra:

- **Trường hợp 1 (`isRoundDone`):** Vẫn còn từ trong `unlearned`.
  - Hiển thị thông báo "Đã hết từ mới".
  - Người dùng bấm "Tiếp tục" -> `handleRetryUnlearned()`:
    - Chép toàn bộ `unlearned` quay trở lại `pool`.
    - Reset `unlearned` về rỗng.
    - **Kết quả:** Người dùng bắt đầu vòng mới chỉ với những từ mình chưa thuộc.

- **Trường hợp 2 (`isAllDone`):** `pool` rỗng VÀ `unlearned` rỗng.
  - Nghĩa là tất cả từ đã nằm trong `learned`.
  - Hiển thị màn hình chúc mừng.
  - Nút chuyển bước gọi `onComplete()` để sang Step 3.

## 4. Giao diện (UI Highlights)
- **Header:** Hiển thị 2 thẻ đếm số lượng Xanh (`learned`) và Đỏ (`unlearned`) giúp người dùng thấy tiến độ.
- **Card Styling:**
  - Khi `isRevealed` là `true`: Background chuyển màu vàng (`#fcd34d`) để báo hiệu đang xem kết quả.
  - Sử dụng CSS Transition cho chiều cao (`max-h`) để tạo hiệu ứng trượt mở nghĩa tiếng Việt mượt mà.